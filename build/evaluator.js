!function t(e,n,r){function a(i,u){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!u&&l)return l(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[i]={exports:{}};e[i][0].call(s.exports,function(t){var n=e[i][1][t];return a(n?n:t)},s,s.exports,t,e,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){e.exports=function(){"use strict";var t={DEFAULT_CONSTANTS:{LOW:{name:"LOW",type:"int",value:0},HIGH:{name:"HIGH",type:"int",value:1},READ:{name:"READ",type:"int",value:0},WRITE:{name:"WRITE",type:"int",value:1}}};return t}()},{}],2:[function(t,e,n){e.exports=function(){"use strict";var t={DEFAULT_FUNCTIONS:{millis:"millis",pinRead:"digitalRead",pinWrite:"digitalWrite",pinMode:"pinMode",print:"Serial.print",println:"Serial.println"}};return t}()},{}],3:[function(t,e,n){(function(n){e.exports=function(){"use strict";function e(t,e,n){this.name=t,this.message=e,this.location=n}var r=t("./modules/SymbolTable"),a=t("./modules/FuncTable"),o=t("./modules/ErrorManager"),i=t("./modules/EvaluatorUtil"),u=(t("./../common/constants").DEFAULT_CONSTANTS,t("./../common/functions").DEFAULT_FUNCTIONS),l=function(t,n){var r=n||null!==t?t.$$:null,a=null;if(r&&(a=s[r](t),a.error))throw console.log(JSON.stringify(a)),new e("SemanticError",a.error.message,a.error.location);return a},c={parse:function(t,e){r.reset(),a.reset();var n=l(t);return{tree:n,symbolScope:r.getTable(),funcScope:a.getTable()}}},s={DOCSTRING:function(t){return t},VARIABLE_STATEMENT:function(t){for(var e=t.type,n=0,a=t.declarations.length;a>n;n++){var u=t.declarations[n],c=null;if(null!==u.init){u.init=l(u.init);var s=i.typeCheck(t.type,u.init.type);if(!s)return o.logError(t,t.location,"type_mismatch",[u.id.name,e]);if(i.isNumber(t.type)&&i.compareNumberTypes(e,u.init.type)<0)return o.logError(t,t.location,"number_doesnt_fit",[u.init.type,e]);t.type=s,c=s}u.type=c;var f=u.id.name,p=r.checkScope(f);if(p)return o.logError(t,u.id.location,"already_exists",[u.id.name,p.value,p.initLine]);var m="{null}";u.init&&(m="{expression}","LITERAL"===u.init.$$&&(m=u.init.value)),r.addSymbol(u,{value:m,type:t.type})}return t},VARIABLE_DECLARATOR:function(t){return t},FUNCTION_DECLARATION:function(t){var e=t.id.name;if(u.hasOwnProperty(e))return o.logError(t,t.location,"cant_redeclare",[e]);var n=a.findFunc(t);if(n)return o.logError(t,t.location,"already_exists",[e,n.initLine]);var c=i.checkParamDuplicates(t.params);if(c)return o.logError(c,c.location,"duplicate_param",[c.id.name]);if(a.addFunc(t),r.enterScope(),t.params)for(var s=!1,f=0,p=t.params.length;p>f;f++){var m=l(t.params[f]);if(m["default"])s=!0;else if(s)return o.logError(t,m.location,"incorrect_params",[e,t.type]);r.addSymbol(m,{value:null,type:m.type})}a.enterFunc(t),t.body=l(t.body);var d=a.getCurrentFunc(),y=d.returns.length;return"void"!==t.type&&0===y?o.logError(t,t.id.location,"must_return",[e,t.type]):(a.exitFunc(),r.exitScope(),t)},PARAM_DECLARATOR:function(t){if(t["default"]){t["default"]=l(t["default"]);var e=i.typeCheck(t.type,t["default"].type,!1);if(!e)return o.logError(t,t.location,"type_mismatch",[t.id.name,t.type])}return t},RETURN_STATEMENT:function(t){t.argument=l(t.argument),t.type=t.argument?t.argument.type:"void";var e=a.getCurrentFunc();if(!e.node)return o.logError(t,t.location,"return_outside");var n=i.typeCheck(t.type,e.node.type);if(!n){var r=t.argument?t.argument.location:t.location;return o.logError(t,r,"type_mismatch",[e.node.id.name,e.node.type])}return a.funcAddReturn(t),t},CALL_STATEMENT:function(t){for(var e=t.callee.name,n=0,r=t.arguments.length;r>n;n++)t.arguments[n]=l(t.arguments[n]);if(u.hasOwnProperty(e))return t;var i=a.findFunc(t);if(!i)return o.logError(t,t.callee.location,"does_not_exist",[e]);if(a.funcHasDefaults(i)&&t.arguments.length<i.params.length)for(var c=i.params.slice(t.arguments.length),n=0,r=c.length;r>n;n++)t.arguments.push(l(c[n]["default"]));return t.type=i.type,t},FOR_STATEMENT:function(t){return r.enterScope(),t.init=l(t.init),t.test=l(t.test),t.update=l(t.update),t.body=l(t.body),r.exitScope(),t},BREAK_STATEMENT:function(t){return t},CONTINUE_STATEMENT:function(t){return t},EXPRESSION_STATEMENT:function(t){var e=l(t.expression);return e},IDENTIFIER:function(t){var e=t.name,n=r.findSymbol(e);return n?(t.type=n.type,t):o.logError(t,t.location,"does_not_exist",[e])},LITERAL:function(t){return"int"===t.type&&(t.type=i.getIntegerType(t.value)),t},BINARY_EXPRESSION:function(t){return t.left=l(t.left),t.right=l(t.right),t.type=i.typeCheck(t.left.type,t.right.type),t.type?t:o.logError(t,t.location,"type_mismatch",[t.operator,t.left.type,t.right.type])},ASSIGNMENT_STATEMENT:function(t){t.right=l(t.right);var e=t.left.name,n=r.findSymbol(e);if(!n)return l(i.constructVarDeclarator(t));t.left=l(t.left);var a=i.typeCheck(t.left.type,t.right.type);return a?t:o.logError(t,t.left.location,"type_mismatch",[t.right.type,t.left.type])},ASSIGNMENT_ACTION:function(t){t.left=l(t.left),t.right=l(t.right);var e=i.typeCheck(t.left.type,t.right.type);return e?t:o.logError(t,t.location,"type_mismatch",[t.right.type,t.left.type])},BLOCK_STATEMENT:function(t){return r.enterScope(),t.body.forEach(function(t){t=l(t)}),r.exitScope(),t},PROGRAM:function(t){return t.body.forEach(function(t){t=l(t)}),t},IF_STATEMENT:function(t){return t.test=l(t.test),"bool"!==t.test.type?o.logError(t,t.test.location,"not_a_bool"):(t.consequent=l(t.consequent),t.alternate&&(t.alternate=l(t.alternate)),t)},LOGICAL_EXPRESSION:function(t){t.left=l(t.left),t.right=l(t.right);var e=i.typeCheck(t.left.type,t.right.type);return e?i.isEqualityOperator(t.operator)||i.isNumber(e)?t:o.logError(t,t.location,"not_a_number",[t.operator]):o.logError(t,t.location,"type_mismatch",[t.left.type,t.right.type])},UPDATE_EXPRESSION:function(t){return t.argument=l(t.argument),i.isNumber(t.argument.type)?(t.type=t.argument.type,t):o.logError(t,t.location,"not_a_number")},UNARY_EXPRESSION:function(t){return t.argument=l(t.argument),"!"===t.operator&&"bool"!==t.argument.type?o.logError(t,t.location,"not_a_bool"):(t.type=t.argument.type,t)}};return n.SparkEvaluator=c,c}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./../common/constants":1,"./../common/functions":2,"./modules/ErrorManager":4,"./modules/EvaluatorUtil":5,"./modules/FuncTable":6,"./modules/SymbolTable":7}],4:[function(t,e,n){e.exports=function(){"use strict";var t={operator:{"+":"add","-":"subtract","*":"multiply","/":"divide"},typeArticle:{"int":"an","byte":"a","long":"a","float":"a",bool:"a",str:"a"}},e={VARIABLE_STATEMENT:{type_mismatch:'variable "{0}" does not match type "{1}"',already_exists:"variable \"{0}\" was already initialized as '{1}' on line {2}",does_not_exist:'variable "{0}" is not defined',number_doesnt_fit:'number of type "{0}" won\'t fit into {typeArticle: 1} "{1}"'},VARIABLE_DECLARATOR:{already_initialized:'variable "{0}" was already initialized as {1} on line {2}',already_declared:'variable "{0}" was already declared on line {1}'},FUNCTION_DECLARATION:{already_exists:'function "{0}" was already declared on line {1}',must_return:'function "{0}" must return {typeArticle: 1} "{1}"',incorrect_params:"parameters with default values must be declared last",cant_redeclare:'can\'t re-declare built-in function "{0}"'},CALL_STATEMENT:{does_not_exist:'function "{0}" does not exist'},PARAM_DECLARATOR:{duplicate_param:'duplicate parameter "{0}"',type_mismatch:'default value for parameter "{0}" must be {typeArticle: 1} "{1}"'},RETURN_STATEMENT:{return_outside:"return statement outside function declaration",type_mismatch:'return statement type does not match function "{0}" of type "{1}"'},IDENTIFIER:{does_not_exist:'variable "{0}" does not exist'},BINARY_EXPRESSION:{type_mismatch:'"{0}" operation types do not match, can\'t {operator: 0} "{1}" and "{2}"'},LOGICAL_EXPRESSION:{type_mismatch:'can\'t compare "{0}" and "{1}"',cant_compare:'can\'t compare "{0}" and "{1}"',not_a_number:'can use "{0}" operator only on numbers'},ASSIGNMENT_STATEMENT:{type_mismatch:'assignment types mismatch, can\'t assign "{0}" to "{1}"'},ASSIGNMENT_ACTION:{type_mismatch:'assignment types mismatch, can\'t assign "{0}" to "{1}"'},UPDATE_EXPRESSION:{not_a_number:"expression is not a number"},UNARY_EXPRESSION:{not_a_bool:"unary expression must be a boolean"},IF_STATEMENT:{not_a_bool:"IF condition must be a boolean"}},n=function(n,r,a,o){var i="string"==typeof n?n:n.$$,u=e[i][a];if(o)for(var l=0,c=o.length;c>l;l++){var s=o[l],f=new RegExp("\\{[ ]*([a-z]+)[ ]*\\:[ ]*"+l+"[ ]*\\}","gi"),p=new RegExp("\\{[ ]*"+l+"[ ]*\\}","gi");u=u.replace(f,function(e,n){var r=t[n];return r[s]}),u=u.replace(p,s)}var m={error:{location:r,message:u,node:n}};return m},r={logError:n};return r}()},{}],5:[function(t,e,n){e.exports=function(){"use strict";var t=["byte","int","long","float"],e=["==","!=","is","is not"],n={"byte":128,"int":32767,"long":2147483647},r={constructVarDeclarator:function(t){return t.$$="VARIABLE_STATEMENT",t.type=t.right.type,t.declarations=[{$$:"VARIABLE_DECLARATOR",id:{location:t.left.location,$$:"IDENTIFIER",name:t.left.name},location:t.left.location,init:t.right}],t},typeCheck:function(e,n,r){if(r)return e===n;if(!e||!n)return!1;if(e===n)return e;var a=t.indexOf(e);if(a>-1){var o=t.indexOf(n);return o>-1?(o>a&&(e=n),e):!1}return!1},checkParamDuplicates:function(t){for(var e=1,n=t.length;n>e;e++)for(var r=t[e],a=0;e>a;a++){var o=t[a];if(o.id.name===r.id.name)return r}return!1},isNumber:function(e){return t.indexOf(e)>-1},compareNumberTypes:function(e,n){var r=t.indexOf(e),a=t.indexOf(n);return r>-1&&a>-1?r-a:-(1/0)},isEqualityOperator:function(t){return e.indexOf(t)>-1},getIntegerType:function(t){var e=parseInt(t,10),r=Math.abs(e),a="int",o=n["long"];for(var i in n)if(n.hasOwnProperty(i)){var u=n[i];u>=r&&o>=u&&(a=i,o=u)}return a}};return r}()},{}],6:[function(t,e,n){e.exports=function(){"use strict";var t={},e={node:null,returns:[]},n=["byte","int","long","float"],r=function(t){return n.indexOf(t)>-1},a={getTable:function(){return t},reset:function(){t={},e={node:null,returns:[]}},getCurrentFunc:function(){return e},enterFunc:function(t){e.node=t},exitFunc:function(){e={node:null,returns:[]}},funcAddReturn:function(t){e.returns.push(t)},getSignature:function(t){var e=t.id||t.callee,n=t.params;"CALL_STATEMENT"===t.$$&&(n=t.arguments);for(var a=e.name+"__",o=!1,i=0,u=n.length;u>i;i++){var l=n[i];!o&&l["default"]&&(a+="|",o=!0);var c=r(l.type)?"num":l.type;a+=c+"_"}return a},getParams:function(t){for(var e=[],n=0,r=t.length;r>n;n++){var a=t[n];e.push({type:a.type,name:a.id.name,"default":a["default"]})}return e},funcHasDefaults:function(t){return null!==t.signature.match(/\|/)},findFunc:function(e){var n=e.id||e.callee,r=n.name,o=a.getSignature(e);if(t.hasOwnProperty(r))for(var i=t[r],u=0,l=i.length;l>u;u++){var c=i[u];if(c.signature===o)return c;if(a.funcHasDefaults(c))for(var s=c.signature.split("|"),f=s[0],p=s[1].split("_").slice(0,-1),m=0,d=p.length;d>=m;m++){var y=f+p.slice(0,m).join("_");if("_"!==y[y.length-1]&&(y+="_"),y===o)return c}}return null},addFunc:function(e){var n=a.getSignature(e),r=e.id.name,o=e.type,i=a.getParams(e.params),u=e.location.start.line,l=e.doc?e.doc.body:"";t[r]||(t[r]=[]);var c={signature:n,type:o,params:i,initLine:u,doc:l,node:e};return t[r].push(c),c}};return a}()},{}],7:[function(t,e,n){e.exports=function(){"use strict";var e=t("../../common/constants").DEFAULT_CONSTANTS,n=1,r={sc0:e,sc1:{}},a=r["sc"+n],o={setInitialScope:function(t){e=t,o.reset()},getTable:function(){return r},reset:function(){n=1,r={sc0:e,sc1:{}},a=r["sc"+n]},enterScope:function(){n+=1,r["sc"+n]={},a=r["sc"+n]},exitScope:function(){n>1&&(r["sc"+n]=null),n-=1,a=r["sc"+n]},getScope:function(t){var e="undefined"!=typeof t?t:n;return r["sc"+e]},findSymbol:function(t){for(var e=n;e>=0;e--){var r=o.getScope(e);if(r.hasOwnProperty(t))return r[t]}return null},addSymbol:function(t,e){var n=e||t.init,r=t.id.name,o=n.value,i=n.type,u=t.location.start.line;a[r]={name:r,value:o,type:i,initLine:u}},checkScope:function(t){return a.hasOwnProperty(t)?a[t]:!1}};return o}()},{"../../common/constants":1}]},{},[3]);
//# sourceMappingURL=maps/evaluator.js.map
